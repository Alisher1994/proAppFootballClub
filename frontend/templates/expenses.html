<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–†–∞—Å—Ö–æ–¥—ã —à–∫–æ–ª—ã</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    {% include '_sidebar.html' %}

    <div class="main-content">
        <div class="page-header">
            <h1>üí∞ –†–∞—Å—Ö–æ–¥—ã —à–∫–æ–ª—ã</h1>
            <button id="addExpenseBtn" class="btn-primary">‚ûï –î–æ–±–∞–≤–∏—Ç—å —Ä–∞—Å—Ö–æ–¥</button>
        </div>
        
        <table class="data-table">
            <thead>
                <tr>
                    <th>–î–∞—Ç–∞</th>
                    <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
                    <th>–°—É–º–º–∞</th>
                    <th>–û–ø–∏—Å–∞–Ω–∏–µ</th>
                    <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                </tr>
            </thead>
            <tbody>
                {% for expense in expenses %}
                <tr>
                    <td>{{ expense.expense_date.strftime('%d.%m.%Y %H:%M') }}</td>
                    <td>{{ expense.category }}</td>
                    <td>{{ "%.0f"|format(expense.amount) }} —Å—É–º</td>
                    <td>{{ expense.description or '-' }}</td>
                    <td>
                        <button
                            class="btn-small btn-info edit-expense-btn"
                            data-id="{{ expense.id }}"
                            data-category="{{ expense.category }}"
                            data-amount="{{ expense.amount }}"
                            data-description="{{ expense.description or '' }}"
                        >‚úèÔ∏è</button>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ: –î–æ–±–∞–≤–∏—Ç—å —Ä–∞—Å—Ö–æ–¥ -->
    <div id="addExpenseModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header-fixed">
                <h2>–î–æ–±–∞–≤–∏—Ç—å —Ä–∞—Å—Ö–æ–¥</h2>
                <div class="modal-header-actions">
                    <button type="button" class="btn-secondary" onclick="document.getElementById('addExpenseModal').style.display='none'">–û—Ç–º–µ–Ω–∞</button>
                    <button type="submit" form="addExpenseForm" class="btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                </div>
            </div>
            <div class="modal-body-scrollable">
                <form id="addExpenseForm">
                    <div class="form-group">
                        <label>–ö–∞—Ç–µ–≥–æ—Ä–∏—è *</label>
                        <select name="category" required>
                            <option value="–ê—Ä–µ–Ω–¥–∞">–ê—Ä–µ–Ω–¥–∞</option>
                            <option value="–ó–∞—Ä–ø–ª–∞—Ç–∞">–ó–∞—Ä–ø–ª–∞—Ç–∞</option>
                            <option value="–û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ">–û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ</option>
                            <option value="–ö–æ–º–º—É–Ω–∞–ª—å–Ω—ã–µ">–ö–æ–º–º—É–Ω–∞–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏</option>
                            <option value="–ü—Ä–æ—á–µ–µ">–ü—Ä–æ—á–µ–µ</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>–°—É–º–º–∞ (—Å—É–º) *</label>
                        <input type="number" name="amount" required>
                    </div>
                    
                    <div class="form-group">
                        <label>–û–ø–∏—Å–∞–Ω–∏–µ</label>
                        <textarea name="description" rows="3"></textarea>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ: –ò–∑–º–µ–Ω–∏—Ç—å —Ä–∞—Å—Ö–æ–¥ -->
    <div id="editExpenseModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header-fixed">
                <h2>–ò–∑–º–µ–Ω–∏—Ç—å —Ä–∞—Å—Ö–æ–¥</h2>
                <div class="modal-header-actions">
                    <button type="button" class="btn-secondary" onclick="document.getElementById('editExpenseModal').style.display='none'">–û—Ç–º–µ–Ω–∞</button>
                    <button type="submit" form="editExpenseForm" class="btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                </div>
            </div>
            <div class="modal-body-scrollable">
                <form id="editExpenseForm">
                    <input type="hidden" name="id" id="editExpenseId">

                    <div class="form-group">
                        <label>–ö–∞—Ç–µ–≥–æ—Ä–∏—è *</label>
                        <select name="category" id="editCategory" required>
                            <option value="–ê—Ä–µ–Ω–¥–∞">–ê—Ä–µ–Ω–¥–∞</option>
                            <option value="–ó–∞—Ä–ø–ª–∞—Ç–∞">–ó–∞—Ä–ø–ª–∞—Ç–∞</option>
                            <option value="–û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ">–û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ</option>
                            <option value="–ö–æ–º–º—É–Ω–∞–ª—å–Ω—ã–µ">–ö–æ–º–º—É–Ω–∞–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏</option>
                            <option value="–ü—Ä–æ—á–µ–µ">–ü—Ä–æ—á–µ–µ</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>–°—É–º–º–∞ (—Å—É–º) *</label>
                        <input type="number" name="amount" id="editAmount" required>
                    </div>
                    
                    <div class="form-group">
                        <label>–û–ø–∏—Å–∞–Ω–∏–µ</label>
                        <textarea name="description" id="editDescription" rows="3"></textarea>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/expenses.js') }}"></script>
    <script src="{{ url_for('static', filename='js/sidebar.js') }}"></script>
</body>
</html>
