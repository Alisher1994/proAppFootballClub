<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–£—á–µ–Ω–∏–∫–∏</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="sidebar">
        <h2>‚öΩ FK QORASUV</h2>
        <nav>
            <a href="{{ url_for('dashboard') }}">üìä –ì–ª–∞–≤–Ω–∞—è</a>
            <a href="{{ url_for('students') }}" class="active">üë• –£—á–µ–Ω–∏–∫–∏</a>
            <a href="{{ url_for('attendance_page') }}">üìã –ü–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å</a>
            <a href="{{ url_for('camera_page') }}">üì∑ –ö–∞–º–µ—Ä–∞</a>
            <a href="{{ url_for('expenses_page') }}">üí∞ –†–∞—Å—Ö–æ–¥—ã</a>
            <a href="{{ url_for('logout') }}">üö™ –í—ã—Ö–æ–¥</a>
        </nav>
    </div>

    <div class="main-content">
        <div class="page-header">
            <h1>üë• –£—á–µ–Ω–∏–∫–∏</h1>
            <button id="addStudentBtn" class="btn-primary">‚ûï –î–æ–±–∞–≤–∏—Ç—å —É—á–µ–Ω–∏–∫–∞</button>
        </div>
        
        <table class="data-table">
            <thead>
                <tr>
                    <th>–§–æ—Ç–æ</th>
                    <th>–ò–º—è</th>
                    <th>–¢–µ–ª–µ—Ñ–æ–Ω</th>
                    <th>–¢–µ–ª. —Ä–æ–¥–∏—Ç–µ–ª—è</th>
                    <th>–ë–∞–ª–∞–Ω—Å</th>
                    <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                </tr>
            </thead>
            <tbody>
                {% for student in students %}
                <tr class="{% if student.balance <= 2 %}low-balance{% endif %}">
                    <td>
                        {% if student.photo_path %}
                        <img src="{{ url_for('static', filename=student.photo_path.replace('frontend/static/', '').replace('\\', '/')) }}" class="student-avatar">
                        {% else %}
                        <div class="avatar-placeholder">üë§</div>
                        {% endif %}
                    </td>
                    <td>{{ student.full_name }}</td>
                    <td>{{ student.phone or '-' }}</td>
                    <td>{{ student.parent_phone or '-' }}</td>
                    <td>
                        <span class="balance-badge {% if student.balance <= 2 %}low{% endif %}">
                            {{ student.balance }}
                        </span>
                    </td>
                    <td>
                        <button class="btn-small btn-success add-payment-btn" data-student-id="{{ student.id }}">üí≥ –û–ø–ª–∞—Ç–∞</button>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ: –î–æ–±–∞–≤–∏—Ç—å —É—á–µ–Ω–∏–∫–∞ -->
    <div id="addStudentModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>–î–æ–±–∞–≤–∏—Ç—å —É—á–µ–Ω–∏–∫–∞</h2>
            
            <form id="addStudentForm" enctype="multipart/form-data">
                <div class="form-group">
                    <label>–§–ò–û *</label>
                    <input type="text" name="full_name" required>
                </div>
                
                <div class="form-group">
                    <label>–¢–µ–ª–µ—Ñ–æ–Ω —É—á–µ–Ω–∏–∫–∞</label>
                    <input type="tel" name="phone">
                </div>
                
                <div class="form-group">
                    <label>–¢–µ–ª–µ—Ñ–æ–Ω —Ä–æ–¥–∏—Ç–µ–ª—è</label>
                    <input type="tel" name="parent_phone">
                </div>
                
                <div class="form-group">
                    <label>–§–æ—Ç–æ *</label>
                    <input type="file" name="photo" accept="image/*" required>
                    <small>–§–æ—Ç–æ –¥–æ–ª–∂–Ω–æ —á—ë—Ç–∫–æ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –ª–∏—Ü–æ</small>
                </div>
                
                <button type="submit" class="btn-primary">–î–æ–±–∞–≤–∏—Ç—å</button>
            </form>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ: –û–ø–ª–∞—Ç–∞ -->
    <div id="paymentModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>–î–æ–±–∞–≤–∏—Ç—å –æ–ø–ª–∞—Ç—É</h2>
            
            <form id="paymentForm">
                <input type="hidden" id="payment_student_id">
                
                <div class="form-group">
                    <label>–°—É–º–º–∞ –æ–ø–ª–∞—Ç—ã (—Å—É–º) *</label>
                    <input type="number" id="payment_amount" required>
                </div>
                
                <div class="form-group">
                    <label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–Ω—è—Ç–∏–π *</label>
                    <input type="number" id="lessons_added" required>
                </div>
                
                <div class="form-group">
                    <label>–¢–∞—Ä–∏—Ñ</label>
                    <select id="tariff_name">
                        <option value="–¢–∞—Ä–∏—Ñ 4">–¢–∞—Ä–∏—Ñ 4 –∑–∞–Ω—è—Ç–∏—è</option>
                        <option value="–¢–∞—Ä–∏—Ñ 8" selected>–¢–∞—Ä–∏—Ñ 8 –∑–∞–Ω—è—Ç–∏–π</option>
                        <option value="–¢–∞—Ä–∏—Ñ 12">–¢–∞—Ä–∏—Ñ 12 –∑–∞–Ω—è—Ç–∏–π</option>
                        <option value="–†–∞–∑–æ–≤–æ–µ">–†–∞–∑–æ–≤–æ–µ –∑–∞–Ω—è—Ç–∏–µ</option>
                    </select>
                </div>
                
                <button type="submit" class="btn-success">–û–ø–ª–∞—Ç–∏—Ç—å</button>
            </form>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/students.js') }}"></script>
</body>
</html>
